<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="VI AI Foundation TTS Devotional Audio - Generate audio for Bible devotionals in multiple languages.">
    <title>VI AI Foundation - TTS Devotional Audio</title>
    <link rel="icon" type="image/x-icon" href="https://tts-cdn.viaifoundation.org/assets/favicon.ico">
    <link rel="icon" type="image/png" href="https://tts-cdn.viaifoundation.org/assets/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="https://tts-cdn.viaifoundation.org/assets/favicon-32x32.png" sizes="32x32">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PRGF9J964B"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-PRGF9J964B');
    </script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .social-media-links img { width: 32px; height: 32px; margin: 0 8px; vertical-align: middle; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <header class="bg-white shadow-md">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center">
                <img src="https://tts-cdn.viaifoundation.org/assets/logo.png" alt="VI AI Foundation Logo" class="h-10 mr-2">
                <h1 class="text-xl font-bold text-indigo-600">VI AI Foundation TTS</h1>
            </div>
            <button id="menu-toggle" class="md:hidden text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
            <div id="menu" class="hidden md:block space-x-6">
                <a href="https://viaifoundation.org" class="text-gray-600 hover:text-indigo-600">Home</a>
                <a href="https://viaifoundation.org/about.html" class="text-gray-600 hover:text-indigo-600">About</a>
                <a href="https://viaifoundation.org/team.html" class="text-gray-600 hover:text-indigo-600">Team</a>
                <a href="https://viaifoundation.org/confessions.html" class="text-gray-600 hover:text-indigo-600">Confessions</a>
                <a href="https://viaifoundation.org/ministries.html" class="text-gray-600 hover:text-indigo-600">Ministries</a>
                <a href="https://viaifoundation.org/events.html" class="text-gray-600 hover:text-indigo-600">Events</a>
                <a href="https://viaifoundation.org/contact.html" class="text-gray-600 hover:text-indigo-600">Contact</a>
            </div>
        </nav>
    </header>
    <div id="root" class="container mx-auto px-6 py-16 max-w-4xl"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const voices = {
            "en": ["en-US-AriaNeural", "en-US-GuyNeural", "en-US-JennyNeural", "en-US-EricNeural", "en-US-SaraNeural"],
            "zh-CN": ["zh-CN-XiaoxiaoNeural", "zh-CN-YunxiNeural", "zh-CN-YunyangNeural", "zh-CN-XiaoyiNeural", "zh-CN-YunjianNeural"],
            "zh-TW": ["zh-TW-HsiaoYuNeural", "zh-TW-YunJheNeural", "zh-TW-HsiaoChenNeural", "zh-TW-YunZeNeural", "zh-TW-XiaoMinNeural"]
        };

        function App() {
            const [token, setToken] = useState("");
            const [username, setUsername] = useState("");
            const [password, setPassword] = useState("");
            const [regUsername, setRegUsername] = useState("");
            const [regPassword, setRegPassword] = useState("");
            const [confirmPassword, setConfirmPassword] = useState("");
            const [language, setLanguage] = useState("en");
            const [paragraphs, setParagraphs] = useState([{ text: "", voice: voices["en"][0] }]);
            const [audioUrl, setAudioUrl] = useState("");
            const [error, setError] = useState("");
            const [showRegister, setShowRegister] = useState(false);

            const handleLogin = async () => {
                const turnstileToken = document.querySelector('.cf-turnstile-login input[name="cf-turnstile-response"]').value;
                if (!turnstileToken) return setError("Please complete the login challenge");
                try {
                    const response = await fetch("https://tts-api.viaifoundation.org/api/token", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: new URLSearchParams({ username, password, 'cf-turnstile-response': turnstileToken })
                    });
                    const data = await response.json();
                    if (response.ok) {
                        setToken(data.access_token);
                        setError("");
                    } else {
                        setError(data.detail || "Server is currently unavailable. Please try again later or contact support at contact@viaifoundation.org.");
                    }
                } catch (e) {
                    setError("Server is currently unavailable. Please try again later or contact support at contact@viaifoundation.org.");
                }
            };

            const handleRegister = async () => {
                if (regPassword !== confirmPassword) return setError("Passwords do not match");
                const turnstileToken = document.querySelector('.cf-turnstile-register input[name="cf-turnstile-response"]').value;
                if (!turnstileToken) return setError("Please complete the registration challenge");
                try {
                    const response = await fetch("https://tts-api.viaifoundation.org/api/register", {
                        method: "POST",
                        headers: { "Content-Type": "application/x-www-form-urlencoded" },
                        body: new URLSearchParams({ username: regUsername, password: regPassword, 'cf-turnstile-response': turnstileToken })
                    });
                    const data = await response.json();
                    if (response.ok) {
                        setError("Registration successful! Please log in.");
                        setShowRegister(false);
                    } else {
                        setError(data.detail || "Server is currently unavailable. Please try again later or contact support at contact@viaifoundation.org.");
                    }
                } catch (e) {
                    setError("Server is currently unavailable. Please try again later or contact support at contact@viaifoundation.org.");
                }
            };

            const handleAddParagraph = () => {
                if (paragraphs.length < 5) {
                    setParagraphs([...paragraphs, { text: "", voice: voices[language][0] }]);
                }
            };

            const handleParagraphChange = (index, field, value) => {
                const newParagraphs = [...paragraphs];
                newParagraphs[index][field] = value;
                setParagraphs(newParagraphs);
            };

            const handleGenerateAudio = async () => {
                const turnstileToken = document.querySelector('.cf-turnstile-generate input[name="cf-turnstile-response"]').value;
                if (!turnstileToken) return setError("Please complete the audio generation challenge");
                try {
                    const response = await fetch("https://tts-api.viaifoundation.org/api/generate_audio", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "Authorization": `Bearer ${token}`
                        },
                        body: JSON.stringify({ language, paragraphs, 'cf-turnstile-response': turnstileToken })
                    });
                    const data = await response.json();
                    if (response.ok) {
                        setAudioUrl(data.file);
                        setError("");
                    } else {
                        setError(data.detail || "Server is currently unavailable. Please try again later or contact support at contact@viaifoundation.org.");
                    }
                } catch (e) {
                    setError("Server is currently unavailable. Please try again later or contact support at contact@viaifoundation.org.");
                }
            };

            return (
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h1 class="text-2xl font-bold mb-4 text-indigo-600">TTS Devotional Audio</h1>
                    {!token ? (
                        <div class="mb-4">
                            {showRegister ? (
                                <div>
                                    <h2 class="text-xl font-semibold mb-2">Register</h2>
                                    <input
                                        type="text"
                                        placeholder="Username"
                                        value={regUsername}
                                        onChange={(e) => setRegUsername(e.target.value)}
                                        class="border p-2 w-full mb-2 rounded"
                                    />
                                    <input
                                        type="password"
                                        placeholder="Password"
                                        value={regPassword}
                                        onChange={(e) => setRegPassword(e.target.value)}
                                        class="border p-2 w-full mb-2 rounded"
                                    />
                                    <input
                                        type="password"
                                        placeholder="Confirm Password"
                                        value={confirmPassword}
                                        onChange={(e) => setConfirmPassword(e.target.value)}
                                        class="border p-2 w-full mb-2 rounded"
                                    />
                                    <div class="cf-turnstile-register mb-2" data-sitekey="0x4AAAAAAB7sgFgraZpkUncS"></div>
                                    <button
                                        onClick={handleRegister}
                                        class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 w-full mb-2"
                                    >
                                        Register
                                    </button>
                                    <button
                                        onClick={() => setShowRegister(false)}
                                        class="text-indigo-600 hover:underline w-full text-center"
                                    >
                                        Back to Login
                                    </button>
                                </div>
                            ) : (
                                <div>
                                    <h2 class="text-xl font-semibold mb-2">Login</h2>
                                    <input
                                        type="text"
                                        placeholder="Username"
                                        value={username}
                                        onChange={(e) => setUsername(e.target.value)}
                                        class="border p-2 w-full mb-2 rounded"
                                    />
                                    <input
                                        type="password"
                                        placeholder="Password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        class="border p-2 w-full mb-2 rounded"
                                    />
                                    <div class="cf-turnstile-login mb-2" data-sitekey="0x4AAAAAAB7sgFgraZpkUncS"></div>
                                    <button
                                        onClick={handleLogin}
                                        class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 w-full mb-2"
                                    >
                                        Login
                                    </button>
                                    <button
                                        onClick={() => setShowRegister(true)}
                                        class="text-indigo-600 hover:underline w-full text-center"
                                    >
                                        Register
                                    </button>
                                </div>
                            )}
                            {error && <p class="text-red-500 mt-2">{error}</p>}
                        </div>
                    ) : (
                        <div>
                            <select
                                value={language}
                                onChange={(e) => {
                                    setLanguage(e.target.value);
                                    setParagraphs(paragraphs.map(p => ({ ...p, voice: voices[e.target.value][0] })));
                                }}
                                class="border p-2 mb-4 rounded w-full"
                            >
                                <option value="en">English</option>
                                <option value="zh-CN">Simplified Chinese</option>
                                <option value="zh-TW">Traditional Chinese</option>
                            </select>
                            {paragraphs.map((para, index) => (
                                <div key={index} class="mb-4">
                                    <textarea
                                        value={para.text}
                                        onChange={(e) => handleParagraphChange(index, "text", e.target.value)}
                                        placeholder={`Paragraph ${index + 1}`}
                                        class="border p-2 w-full mb-2 rounded"
                                        rows="4"
                                    />
                                    <select
                                        value={para.voice}
                                        onChange={(e) => handleParagraphChange(index, "voice", e.target.value)}
                                        class="border p-2 w-full rounded"
                                    >
                                        {voices[language].map(voice => (
                                            <option key={voice} value={voice}>{voice}</option>
                                        ))}
                                    </select>
                                </div>
                            ))}
                            {paragraphs.length < 5 && (
                                <button
                                    onClick={handleAddParagraph}
                                    class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mb-4 w-full"
                                >
                                    Add Paragraph
                                </button>
                            )}
                            <div class="cf-turnstile-generate mb-2" data-sitekey="0x4AAAAAAB7sgFgraZpkUncS"></div>
                            <button
                                onClick={handleGenerateAudio}
                                class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 w-full"
                            >
                                Generate Audio
                            </button>
                            {audioUrl && (
                                <div class="mt-4">
                                    <audio controls src={audioUrl} class="w-full"></audio>
                                </div>
                            )}
                            {error && <p class="text-red-500 mt-2">{error}</p>}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById("root"));
    </script>
    <footer class="bg-gray-800 text-white py-6 text-center">
        <div class="social-media-links">
            <a href="https://x.com/viaifoundation" target="_blank" title="Follow us on X">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/x.svg" alt="X" class="inline-block w-8 h-8 mx-2">
            </a>
            <a href="https://www.youtube.com/@viaifoundation" target="_blank" title="Subscribe on YouTube">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/youtube.svg" alt="YouTube" class="inline-block w-8 h-8 mx-2">
            </a>
            <a href="https://www.facebook.com/viaifoundation" target="_blank" title="Like us on Facebook">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/facebook.svg" alt="Facebook" class="inline-block w-8 h-8 mx-2">
            </a>
            <a href="https://www.linkedin.com/company/viaifoundation" target="_blank" title="Connect on LinkedIn">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/linkedin.svg" alt="LinkedIn" class="inline-block w-8 h-8 mx-2">
            </a>
            <a href="https://www.tiktok.com/@viaifoundation" target="_blank" title="Follow us on TikTok">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/tiktok.svg" alt="TikTok" class="inline-block w-8 h-8 mx-2">
            </a>
            <a href="https://www.instagram.com/viaifoundation" target="_blank" title="Follow us on Instagram">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/instagram.svg" alt="Instagram" class="inline-block w-8 h-8 mx-2">
            </a>
            <a href="https://medium.com/@viaifoundation" target="_blank" title="Read our blog on Medium">
                <img src="https://cdn.jsdelivr.net/npm/simple-icons@v13.7.0/icons/medium.svg" alt="Medium" class="inline-block w-8 h-8 mx-2">
            </a>
        </div>
        <p class="mt-4">© 2025 VI AI Foundation, a 501(c)(3) nonprofit charity in Saratoga, CA. All rights reserved.</p>
        <p class="mt-2"><a href="https://viaifoundation.org/privacy.html" class="text-indigo-400 hover:underline">Privacy Policy</a></p>
    </footer>
    <script>
        document.getElementById('menu-toggle').addEventListener('click', () => {
            document.getElementById('menu').classList.toggle('hidden');
        });
    </script>
</body>
</html>